<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weighted Slot Machine</title>
<style>
    body {
        background: linear-gradient(135deg, #1e1e2f, #2b2b45);
        color: white;
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }

    .slot-machine {
        background: #111;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 0 30px #000;
        text-align: center;
        width: 420px;
    }

    .reels {
        display: flex;
        justify-content: space-between;
        margin: 20px 0;
    }

    .reel {
        background: #222;
        width: 80px;
        height: 80px;
        font-size: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 10px;
        box-shadow: inset 0 0 10px #000;
        transition: transform 0.1s ease;
    }

    button {
        padding: 12px 25px;
        font-size: 18px;
        border: none;
        border-radius: 10px;
        background: gold;
        color: black;
        cursor: pointer;
        font-weight: bold;
        transition: 0.2s;
        margin: 5px;
    }

    button:hover {
        background: orange;
    }

    .money {
        margin-top: 10px;
        font-size: 22px;
    }

    .result {
        margin-top: 15px;
        font-size: 20px;
        height: 30px;
    }
</style>
</head>
<body>

<div class="slot-machine">
    <h1>üé∞ Slot Machine</h1>
    <div class="reels">
        <div class="reel" id="reel1">üçí</div>
        <div class="reel" id="reel2">üçã</div>
        <div class="reel" id="reel3">üçä</div>
    </div>
    <div class="money" id="money">üí∞ Money: $100</div>
    <button onclick="spin()">SPIN ($10)</button>
    <button onclick="window.location='../../content/pages/section1.html'">‚¨Ö Back</button>
    <div class="result" id="result"></div>

    <!-- Sounds -->
    <audio id="spinSound" src="spin.mp3"></audio>
    <audio id="winSound" src="win.mp3"></audio>
    <audio id="jackpotSound" src="jackpot.mp3"></audio>
</div>

<script>
    // Weighted symbols: {symbol: weight}
    const weightedSymbols = [
        {symbol: "üçí", weight: 30}, // very common
        {symbol: "üçã", weight: 25},
        {symbol: "üçä", weight: 20},
        {symbol: "‚≠ê", weight: 15},
        {symbol: "üíé", weight: 7},
        {symbol: "7Ô∏è‚É£", weight: 3} // jackpot rarity
    ];

    let money = 100;
    const costPerSpin = 10;

    function updateMoney() {
        document.getElementById("money").textContent = `üí∞ Money: $${money}`;
    }

    function playSound(id) {
        const sound = document.getElementById(id);
        if(sound){
            sound.currentTime = 0;
            sound.play();
        }
    }

    // Get random symbol based on weights
    function getRandomSymbol() {
        const totalWeight = weightedSymbols.reduce((sum, s) => sum + s.weight, 0);
        let random = Math.random() * totalWeight;
        for (let s of weightedSymbols) {
            if (random < s.weight) return s.symbol;
            random -= s.weight;
        }
        return weightedSymbols[0].symbol; // fallback
    }

    function spin() {
        if(money < costPerSpin){
            document.getElementById("result").textContent = "üí∏ Not enough money!";
            return;
        }

        money -= costPerSpin;
        updateMoney();
        playSound("spinSound");

        const reel1 = document.getElementById("reel1");
        const reel2 = document.getElementById("reel2");
        const reel3 = document.getElementById("reel3");
        const result = document.getElementById("result");
        result.textContent = "";

        let spins = 15;
        const interval = setInterval(() => {
            reel1.textContent = getRandomSymbol();
            reel2.textContent = getRandomSymbol();
            reel3.textContent = getRandomSymbol();
            spins--;

            if(spins <= 0){
                clearInterval(interval);

                // Determine win
                if(reel1.textContent === reel2.textContent && reel2.textContent === reel3.textContent){
                    // Jackpot depends on symbol
                    let payout = 0;
                    if(reel1.textContent === "7Ô∏è‚É£") payout = 200;
                    else if(reel1.textContent === "üíé") payout = 100;
                    else payout = 50;

                    money += payout;
                    result.textContent = `üéâ JACKPOT! ${reel1.textContent} +$${payout}`;
                    playSound("jackpotSound");

                } else if (
                    reel1.textContent === reel2.textContent ||
                    reel2.textContent === reel3.textContent ||
                    reel1.textContent === reel3.textContent
                ){
                    const payout = 20;
                    money += payout;
                    result.textContent = `‚ú® Small Win! +$${payout}`;
                    playSound("winSound");
                } else {
                    result.textContent = "Try Again!";
                }

                updateMoney();
            }

        }, 100);
    }

</script>
</body>
</html>
